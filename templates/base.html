<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Code Grader{% endblock %}</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
  />
  <!-- Highlight.js for code display -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/github-dark.min.css"
  />
  <style>
    body { background-color: #f8f9fa; }
    .navbar-brand { font-weight: 700; letter-spacing: -0.5px; }
    .score-badge { font-size: 2rem; font-weight: 700; }
    .code-block pre { margin: 0; border-radius: 0.5rem; max-height: 500px; overflow-y: auto; }
    .criteria-list li { margin-bottom: 0.25rem; }
    textarea.font-monospace { font-size: 0.875rem; }
    .feedback-body h2, .feedback-body h3 { font-size: 1.1rem; margin-top: 1rem; }
    .feedback-body ul { padding-left: 1.2rem; }
  </style>
  <!-- MathJax for LaTeX rendering in theory questions -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['$','$'],['\\(','\\)']], displayMath: [['$$','$$'],['\\[','\\]']], processEscapes: true },
      options: { skipHtmlTags: ['script','noscript','style','textarea','pre','code'] }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" async></script>
  {% block extra_head %}{% endblock %}
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container">
      <a class="navbar-brand" href="{% url 'home' %}">
        <i class="bi bi-mortarboard-fill me-1"></i>Code Grader
      </a>
      <div class="navbar-nav ms-auto">
        <a class="nav-link" href="{% url 'coding_list' %}">
          <i class="bi bi-code-slash me-1"></i>Python Coding
        </a>
        <a class="nav-link" href="{% url 'theory_list' %}">
          <i class="bi bi-journal-text me-1"></i>ML/AI Theory
        </a>
        <a class="nav-link btn btn-sm btn-primary ms-2 text-white px-3"
           href="{% url 'problem_create' %}">
          <i class="bi bi-plus-lg"></i> New Problem
        </a>
      </div>
    </div>
  </nav>

  <div class="container pb-5">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    {% endfor %}

    {% block content %}{% endblock %}
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <!-- Simple markdown-to-HTML for feedback rendering -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    document.querySelectorAll(".render-markdown").forEach(el => {
      el.innerHTML = marked.parse(el.textContent);
    });
  </script>
  {% block extra_scripts %}{% endblock %}
</body>
</html>
